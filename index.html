<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Media Player</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; }
        
        /* PLAYER BOX: Iski height fixed kar di hai taaki photo badi na dikhe */
        .player-container { 
            width: 95%; 
            max-width: 500px; 
            aspect-ratio: 16/9; 
            background: #111; 
            position: relative; 
            border-radius: 12px; 
            overflow: hidden; 
            border: 1px solid #333;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        /* Photo/Video dono box ke andar fit rahenge */
        #mainMedia, #mainPhoto { 
            width: 100%; 
            height: 100%; 
            object-fit: contain; /* Isse photo kat-ti nahi hai aur fit rehti hai */
            filter: blur(50px); 
            transition: 0.5s; 
            background: #000;
        }
        
        /* Play Button Overlay */
        #playOverlay { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            display: flex; justify-content: center; align-items: center; 
            background: rgba(0,0,0,0.4); z-index: 10; cursor: pointer; 
        }
        .play-circle { 
            width: 65px; height: 65px; background: rgba(255,0,0,0.95); 
            border-radius: 50%; display: flex; justify-content: center; 
            align-items: center; font-size: 28px; border: 2px solid #fff; 
        }

        /* Skip Ad UI */
        #skipContainer { position: absolute; bottom: 30px; right: 0; display: none; z-index: 20; }
        .skip-box { 
            background: rgba(0,0,0,0.85); border: 1px solid #444; color: #fff; 
            padding: 8px 15px; font-size: 14px; border-right: none; 
            border-top-left-radius: 4px; border-bottom-left-radius: 4px;
        }
        .skip-btn { cursor: pointer; color: #fff; font-weight: bold; }

        /* Admin Box */
        .admin-box { padding: 20px; background: #1a1a1a; border-radius: 10px; width: 90%; max-width: 400px; margin-top: 20px; }
        input { width: 85%; padding: 10px; margin: 10px 0; background: #222; border: 1px solid #444; color: #fff; border-radius: 5px; }
        .btn { background: #00ffa3; color: #000; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<div id="userPanel" style="display:none; width: 100%; display: flex; flex-direction: column; align-items: center;">
    <div class="player-container">
        <video id="mainMedia" playsinline loop muted></video>
        <img id="mainPhoto" style="display:none;">

        <div id="playOverlay" onclick="startAdSequence()">
            <div class="play-circle">▶</div>
        </div>

        <div id="skipContainer">
            <div class="skip-box">
                <span id="skipLabel">Skip in 5</span>
            </div>
        </div>
    </div>
    <p style="color:#888; font-size:12px; margin-top:15px;">Video unlock karne ke liye ▶ dabayein</p>
</div>

<div id="loginUI" class="admin-box">
    <h3>Admin Login</h3>
    <input type="password" id="adminPass" placeholder="Password">
    <button class="btn" onclick="checkLogin()">Login</button>
</div>

<div id="uploadUI" class="admin-box" style="display:none;">
    <h3>Upload Gallery File</h3>
    <input type="file" id="fileInput">
    <button class="btn" onclick="uploadNow()">Generate Link</button>
    <div id="linkOutput" style="margin-top:15px; display:none;">
        <input type="text" id="finalLink" readonly style="color:#00ffa3; font-size:11px;">
        <button class="btn" onclick="copyText()" style="padding:5px 10px;">Copy</button>
    </div>
</div>

<script>
    const CLOUD = "dn10tsupa"; 
    const PRESET = "dn10tsupa";

    const params = new URLSearchParams(window.location.search);
    const mediaUrl = params.get('m');

    if (mediaUrl) {
        document.getElementById('loginUI').style.display = 'none';
        document.getElementById('userPanel').style.display = 'flex';
        if (mediaUrl.match(/\.(mp4|mov|webm|m4v)/i)) {
            document.getElementById('mainMedia').src = mediaUrl;
        } else {
            document.getElementById('mainMedia').style.display = 'none';
            document.getElementById('mainPhoto').src = mediaUrl;
            document.getElementById('mainPhoto').style.display = 'block';
        }
    }

    function startAdSequence() {
        window.open('https://www.google.com', '_blank'); // Adsterra Direct Link
        document.getElementById('playOverlay').style.pointerEvents = "none";
        document.getElementById('skipContainer').style.display = "block";
        
        let timeLeft = 5;
        let countdown = setInterval(() => {
            timeLeft--;
            if(timeLeft > 0) {
                document.getElementById('skipLabel').innerText = "Skip in " + timeLeft;
            } else {
                clearInterval(countdown);
                document.getElementById('skipLabel').innerHTML = '<span class="skip-btn" onclick="unlockContent()">Skip Ad ⏩</span>';
            }
        }, 1000);
    }

    function unlockContent() {
        document.getElementById('playOverlay').style.display = "none";
        document.getElementById('skipContainer').style.display = "none";
        const video = document.getElementById('mainMedia');
        const photo = document.getElementById('mainPhoto');
        video.style.filter = "blur(0px)";
        photo.style.filter = "blur(0px)";
        if(video.src) { video.muted = false; video.play(); }
    }

    function checkLogin() {
        if(document.getElementById('adminPass').value === "1234") {
            document.getElementById('loginUI').style.display = 'none';
            document.getElementById('uploadUI').style.display = 'block';
        }
    }

    async function uploadNow() {
        const file = document.getElementById('fileInput').files[0];
        if(!file) return;
        const type = file.type.startsWith('video') ? 'video' : 'image';
        const fd = new FormData();
        fd.append("file", file); fd.append("upload_preset", PRESET);
        const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD}/${type}/upload`, {method:"POST", body:fd});
        const data = await res.json();
        if(data.secure_url) {
            document.getElementById('finalLink').value = window.location.origin + window.location.pathname + "?m=" + data.secure_url;
            document.getElementById('linkOutput').style.display = "block";
        }
    }

    function copyText() {
        document.getElementById('finalLink').select();
        document.execCommand('copy');
        alert("Copied!");
    }
</script>

<script type='text/javascript' src='//pl25732282.effectivegatecpm.com/6d/5a/e2/6d5ae25a8b0c2974cabf7d073c7cc9f8.js'></script>
</body>
</html>
