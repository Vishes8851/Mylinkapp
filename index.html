<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viral Video Player | Watch Now</title>
    <style>
        body { background: #000; color: #fff; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; overflow-x: hidden; }
        .main-container { width: 100%; max-width: 600px; margin: auto; padding-top: 20px; }
        
        /* Video Player Area */
        #playerBox { width: 95%; margin: auto; aspect-ratio: 9/16; background: #111; border-radius: 15px; position: relative; overflow: hidden; box-shadow: 0 0 20px rgba(255,0,0,0.3); }
        #mainVideo { width: 100%; height: 100%; object-fit: cover; filter: blur(10px); }
        
        /* Fake Overlay Layer */
        #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10; cursor: pointer; }
        .play-icon { width: 70px; height: 70px; background: #f00; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 0 0 15px #f00; }
        .play-icon::after { content: ''; border-left: 25px solid #fff; border-top: 15px solid transparent; border-bottom: 15px solid transparent; margin-left: 8px; }
        .banner-text { margin-top: 20px; font-size: 22px; font-weight: bold; color: #fff; text-shadow: 2px 2px 10px #000; text-align: center; padding: 0 10px; }

        /* Ad Box System */
        #adLayer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000; display: none; z-index: 100; }
        #adFrame { width: 100%; height: 100%; border: none; }
        #timerBtn { position: absolute; bottom: 30px; right: 20px; background: #333; color: #fff; padding: 12px 25px; border: 2px solid #fff; font-weight: bold; border-radius: 30px; z-index: 101; cursor: not-allowed; transition: 0.3s; }

        /* Admin Dashboard */
        #adminPanel { background: #1a1a1a; padding: 25px; margin: 20px; border-radius: 15px; border: 1px solid #333; }
        .admin-title { color: #f00; font-size: 24px; margin-bottom: 15px; }
        input[type="file"] { background: #333; color: #fff; padding: 10px; width: 100%; border-radius: 5px; margin-bottom: 15px; }
        #genBtn { background: #f00; color: #fff; border: none; padding: 15px; width: 100%; font-size: 18px; font-weight: bold; border-radius: 5px; cursor: pointer; }
        #linkResult { margin-top: 20px; display: none; }
        #finalLink { width: 100%; padding: 10px; background: #000; color: #0f0; border: 1px solid #0f0; text-align: center; }
    </style>
</head>
<body>

<div class="main-container">
    <div id="userUI" style="display:none;">
        <div id="playerBox">
            <video id="mainVideo" loop muted playsinline></video>
            <div id="overlay" onclick="startAd()">
                <div class="play-icon"></div>
                <div class="banner-text">‚ö†Ô∏è VIRAL VIDEO UNLOCKED ‚ö†Ô∏è<br><small>Click to play & wait 5 seconds</small></div>
            </div>
            <div id="adLayer">
                <iframe id="adFrame"></iframe>
                <div id="timerBtn">Wait 5s...</div>
            </div>
        </div>
    </div>

    <div id="adminPanel">
        <div class="admin-title">üöÄ Viral Link Generator</div>
        <p>Upload any video (Cat, Comedy, Action) to get a lifetime link.</p>
        <input type="file" id="videoInput" accept="video/*">
        <button id="genBtn" onclick="uploadAndGen()">CREATE VIRAL LINK</button>
        
        <div id="linkResult">
            <p>‚úÖ Your Link is Ready! Share it in groups:</p>
            <input type="text" id="finalLink" readonly>
        </div>
    </div>
</div>

<script>
    // --- SETTINGS ---
    const AD_LINK = "https://www.effectivegatecpm.com/n1142d7c5v?key=41bc70c49790bd21e2c627fcefc7f3d7"; // Your Adsterra Link
    const CLOUD_NAME = "dn10tsupa";
    const UPLOAD_PRESET = "dn10tsupa"; 

    // --- CHECK FOR VIDEO IN URL ---
    const params = new URLSearchParams(window.location.search);
    const videoUrl = params.get('v');

    if(videoUrl) {
        document.getElementById('adminPanel').style.display = 'none';
        document.getElementById('userUI').style.display = 'block';
        document.getElementById('mainVideo').src = videoUrl;
    }

    // --- AD SYSTEM LOGIC ---
    function startAd() {
        document.getElementById('adLayer').style.display = 'block';
        document.getElementById('adFrame').src = AD_LINK;
        let time = 5;
        let counter = setInterval(() => {
            time--;
            document.getElementById('timerBtn').innerText = "Wait " + time + "s...";
            if(time <= 0) {
                clearInterval(counter);
                const btn = document.getElementById('timerBtn');
                btn.innerText = "SKIP AD & WATCH ‚è©";
                btn.style.background = "#0f0";
                btn.style.color = "#000";
                btn.style.cursor = "pointer";
                btn.onclick = () => {
                    document.getElementById('adLayer').style.display = 'none';
                    document.getElementById('mainVideo').style.filter = 'none';
                    document.getElementById('mainVideo').muted = false;
                    document.getElementById('mainVideo').play();
                };
            }
        }, 1000);
    }

    // --- UPLOAD LOGIC ---
    async function uploadAndGen() {
        const file = document.getElementById('videoInput').files[0];
        if(!file) return alert("Bhai, pehle video toh select karo!");

        document.getElementById('genBtn').innerText = "Processing... Please wait";
        document.getElementById('genBtn').disabled = true;

        const formData = new FormData();
        formData.append("file", file);
        formData.append("upload_preset", UPLOAD_PRESET);

        try {
            const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/video/upload`, {
                method: "POST",
                body: formData
            });
            const data = await res.json();
            const shareableLink = window.location.href.split('?')[0] + "?v=" + data.secure_url;
            
            document.getElementById('finalLink').value = shareableLink;
            document.getElementById('linkResult').style.display = 'block';
            document.getElementById('genBtn').innerText = "CREATE ANOTHER LINK";
            document.getElementById('genBtn').disabled = false;
        } catch (e) {
            alert("Upload failed! Check Cloudinary settings.");
            document.getElementById('genBtn').innerText = "TRY AGAIN";
            document.getElementById('genBtn').disabled = false;
        }
    }
</script>
</body>
</html>
